# 数据库和缓存一致性：缓存更新的套路
### 方案一： 延时双删
先删除Redis缓存数据，再更新MySQL，延迟几百毫秒再删除Redis缓存数据，这样就算再更新MySQL时，有其他线程读取了MySQL,把老数据读取到Redis中，那么也会被删除，从而保持数据一致性。


### 方案二： 队列 + 重试机制
> 处理方案一缓存数据删除失败的场景

将 需要删除的Key发送至消息队列，再自行消费Key删除消息。


### 档案三： 异步更新缓存
MySQL中产生了新的写入、更新、删除操作，就可以把binlog相关的消息推送到Redis，Redis再根据binlog中的记录，对Redis进行更新。
> 类似于MySQL主从备份机制。

阿里开源框架 canal , 通过该框架可以对MySQL的binlog进行订阅，而canal正是模仿了MySQL的slave数据库的备份请求，使Redis的数据更新达到了相同的效果。